# Exchange Analytics - 修正版本格運用Crontab設定
SHELL=/bin/bash
PATH=/usr/local/bin:/usr/bin:/bin
HOME=/app

# 🧪 基本テスト（毎分実行）
* * * * * echo "$(date): Cron is working!" >> /app/logs/cron_test.log

# 🔧 環境変数読み込みテスト（2分間隔）
*/2 * * * * cd /app && export $(cat .env | grep -v '^#' | xargs) && timeout 30 python test_env_loading.py >> /app/logs/env_test_cron.log 2>&1

# 📊 データスケジューラーテスト（3分間隔）
*/3 * * * * cd /app && export $(cat .env | grep -v '^#' | xargs) && timeout 60 python data_scheduler.py --test >> /app/logs/scheduler_cron.log 2>&1

# 🌐 APIヘルスチェック（5分間隔）
*/5 * * * * timeout 5 curl -s http://localhost:8000/health >> /app/logs/api_health_cron.log 2>&1 || echo "$(date): API check failed" >> /app/logs/api_health_cron.log
