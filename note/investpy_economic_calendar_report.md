# investpy 経済カレンダー API レポート

## 概要
**investpy** は、Investing.com から各種金融データを取得する Python ライブラリである。
その中でも `economic_calendar()` 関数を利用すると、世界各国の経済イベント・指標を取得できる。

対象は CPI・GDP・雇用関連・政策金利発表・PMI・貿易収支・住宅関連指標・祝日など幅広い。

## 取得できるデータ
返却形式は **pandas.DataFrame**。主な列は以下の通り。

- `date`：日付  
- `time`：時刻（または残り時間）  
- `zone` / `country`：国・地域  
- `event`：イベント名（例：米国消費者物価指数 (CPI)）  
- `importance`：重要度（low / medium / high）  
- `actual`：実際の発表値  
- `forecast`：予測値（市場予想）  
- `previous`：前回値  

## 主な指定パラメータ
- **time_zone**： `'GMT +9:00'` のように指定可能。JST で利用する場合は `GMT +9:00`。  
- **time_filter**： `'time_only'`（時刻）または `'time_remain'`（残り時間）。  
- **countries**： `['japan', 'united states']` のように国をリスト指定。未指定は全世界。  
- **importances**： `['high', 'medium', 'low']` で重要度をフィルタ。  
- **categories**： カテゴリ（インフレ、雇用など）を指定可能。  
- **from_date / to_date**： `'dd/mm/yyyy'` 形式で期間を指定。未指定は当日のみ。  

## 特徴と活用法
- **当日チェック**： 日本・米国など重要国に絞り、重要度「高」だけを取得。  
- **週次プラン**： from_date/to_date を週に設定し、週間イベントを整理。  
- **直前監視**： time_filter='time_remain' で“あと何分で発表か”を確認。  
- **バックテスト**： 過去期間を指定して取得し、実際の値と予測の差を「サプライズ」として検証可能。  

## 注意点
- **予測値（forecast）は含まれる**が、イベントによっては欠損する。  
- **タイムゾーンの挙動が不安定**と報告されているため、UTC で受けてから JST に変換するのが無難。  
- **Investing.com 側の仕様変更**で一時的に取得できなくなることがある。ライブラリ更新状況を随時確認する必要がある。  
- **公式ドキュメントは v1.0.8 (2022年10月)** とやや古いため、実際の挙動は検証が必要。  

## 結論
investpy の経済カレンダー API は、**当日または任意期間の経済指標を予測値つきで取得可能**であり、  
日々のトレード準備やバックテストに十分活用できる。ただし、タイムゾーンや安定性の課題には注意が必要である。


## 運用方針の提案（取得スケジュール）

### 比較: 週次一括取得 vs 当日取得
- **週次（日曜に翌週分まとめて取得）**
  - メリット: 全体像を先に把握可能、実行回数が少なく安定。
  - デメリット: 予測値やスケジュール修正を取りこぼす可能性。

- **当日取得（毎朝その日の分を取得）**
  - メリット: 直前の最新データを反映できる。
  - デメリット: 中期的な視野を欠く。

### 推奨: ハイブリッド運用（週次＋日次＋直前）
1. **週次ベースライン（日曜 09:00 JST）**
   - 翌週分をまとめて取得。
   - 重要イベントを先に把握。

2. **日次リフレッシュ（毎朝 07:00 JST）**
   - 当日分を再取得し、予測値やイベント追加・修正を反映。
   - 変更差分を検出しアラート。

3. **直前チェック（イベント帯の30〜60分前）**
   - 発表直前の予測値を取得。
   - 発表後10〜15分で actual を再取得（速報値と改定値の差分把握も可能）。

### データ管理上の注意
- **UTCで保存 → 表示時にJST変換**（夏時間対策）。
- **キー項目**: `(date_utc, country, event_name, scheduled_time_utc)` を基準に管理。
- **差分検出**: forecast の変更率や scheduled_time の変化をトリガーに。

### 結論
- 週次で全体像を固め、日次・直前で変化を補足する「ハイブリッド運用」が最も実用的。
